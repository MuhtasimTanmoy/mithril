(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[480],{3195:function(e,r,s){Promise.resolve().then(s.bind(s,6465))},6465:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return y}});var t=s(7437),n=s(7907),i=s(2265),a=s(828),c=s(9792),o=s(7019),d=s(5900),h=s(7840),l=s(5914),g=s(8826),u=s(6480),x=s.n(u),j=s(2865);let v=i.forwardRef((e,r)=>{let{bsPrefix:s,size:n,vertical:i=!1,className:a,role:c="group",as:o="div",...d}=e,h=(0,j.vE)(s,"btn-group"),l=h;return i&&(l="".concat(h,"-vertical")),(0,t.jsx)(o,{...d,ref:r,role:c,className:x()(a,l,n&&"".concat(h,"-").concat(n))})});v.displayName="ButtonGroup";var p=s(477),f=s(590),Z=s(6136),k=s(1196),m=s(9064),b=s(7585),w=s(1860),S=s(9957),N=s(825),E=s(7898);function y(){var e,r;let s=(0,a.I0)(),u=(0,n.useSearchParams)(),[x,j]=(0,i.useState)(!0),[Z,y]=(0,i.useState)(void 0),[_,T]=(0,i.useState)(void 0),[R,B]=(0,i.useState)(void 0),[C,I]=(0,i.useState)(void 0),[L,P]=(0,i.useState)(void 0),[U,W]=(0,i.useState)([]),[A,F]=(0,i.useState)({stakesBreakdown:{},signersWeight:{}});(0,i.useEffect)(()=>{let e;let r=u.get(m.W),t=Number(u.get("epoch"));T(r),B(t),(0,o.checkUrl)(r)?Number.isInteger(t)||(e="invalidEpoch"):e="invalidAggregatorUrl",void 0===e?(fetch("".concat(r,"/signers/registered/").concat(t)).then(e=>200===e.status?e.json():{}).then(e=>{I(e.signing_at),W(e.registrations),F({stakesBreakdown:(0,c.Q2)(e.registrations),signersWeight:(0,c.Fw)(e.registrations)}),j(!1)}).catch(e=>{I(void 0),W([]),j(!1),console.error("Fetch registrations error:",e)}),fetch("".concat(r,"/epoch-settings")).then(e=>200===e.status?e.json():{}).then(e=>P(null==e?void 0:e.epoch)).catch(e=>{P(void 0),console.error("Fetch current epoch in epoch-settings error:",e)}),s((0,b.Q9)(r))):y(e)},[u]);let O=(0,i.useCallback)(e=>{let r=new URLSearchParams;return r.set("aggregator",_),r.set("epoch",e),"/registrations?".concat(r.toString())},[_]),Q=O(R-1),D=O(L),H=O(R+1);if(void 0!==Z){let e="";switch(Z){case"invalidEpoch":e="The given epoch isn't an integer, please correct it and try again.";break;case"invalidAggregatorUrl":e="The given aggregator isn't a valid url, please correct it and try again.";break;default:e="Something went wrong"}return(0,t.jsxs)(d.Z,{gap:3,children:[(0,t.jsx)("h2",{children:"Registrations"}),(0,t.jsxs)(h.Z,{variant:"danger",children:[(0,t.jsx)(h.Z.Heading,{children:"Oh snap! You got an error!"}),(0,t.jsx)("p",{children:e})]})]})}return(0,t.jsxs)(d.Z,{gap:3,children:[(0,t.jsxs)("h2",{children:["Registrations"," ",(0,t.jsx)(N.Z,{href:"".concat(_,"/signers/registered/").concat(R),variant:"outline-light",size:"sm"})]}),(0,t.jsx)(l.Z,{children:(0,t.jsx)(g.Z,{children:(0,t.jsxs)("tbody",{children:[(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)("strong",{children:"Aggregator:"})}),(0,t.jsx)("td",{children:_})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)("strong",{children:"Registration epoch:"})}),(0,t.jsx)("td",{children:R})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)("strong",{children:"Signing at epoch:"})}),(0,t.jsx)("td",{children:null!=C?C:"?"})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)("strong",{children:"Number of signers:"})}),(0,t.jsx)("td",{children:null!==(e=null==U?void 0:U.length)&&void 0!==e?e:0})]}),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,t.jsx)("strong",{children:"Total stakes:"})}),(0,t.jsx)("td",{children:(0,t.jsx)(S.Z,{lovelace:null!==(r=null==U?void 0:U.reduce((e,r)=>e+r.stake,0))&&void 0!==r?r:0})})]})]})})}),(0,t.jsx)(l.Z,{children:(0,t.jsx)("div",{children:Number.isInteger(R)&&(0,t.jsxs)(v,{children:[(0,t.jsxs)(w.Z,{href:Q,children:["Previous Epoch (",R-1,")"]}),(0,t.jsxs)(w.Z,{href:D,disabled:void 0===L||L===R,children:["Current Epoch (",L,")"]}),(0,t.jsxs)(w.Z,{href:H,disabled:L<=R,children:["Next Epoch (",R+1,")"]})]})})}),x?(0,t.jsx)(p.Z,{animation:"grow"}):void 0===U||0===U.length?(0,t.jsxs)(h.Z,{variant:"info",children:[(0,t.jsxs)(h.Z.Heading,{children:["No registrations for epoch ",R]}),(0,t.jsx)("p",{children:L===R?"The aggregator did not receive registrations yet for the current epoch.":L<R?"The epoch is in the future":"The aggregator may have pruned old registrations or wasn't running at this epoch."})]}):(0,t.jsxs)(l.Z,{children:[(0,t.jsxs)(f.Z,{xs:12,sm:12,md:7,children:[(0,t.jsx)("h3",{children:"Signers"}),(0,t.jsx)(E.Z,{signers:U,displayIndexes:!0})]}),(0,t.jsx)(f.Z,{xs:12,sm:12,md:5,children:(0,t.jsxs)(d.Z,{gap:3,children:[(0,t.jsx)("h3",{children:"Stakes breakdown"}),(0,t.jsx)(k.$Q,{data:A.stakesBreakdown}),(0,t.jsx)("h3",{children:"Signers weight"}),(0,t.jsx)(k.by,{data:A.signersWeight})]})})]})]})}Z.kL.register(Z.qi,Z.uw,Z.f$,Z.ZL,Z.Dx,Z.u,Z.De),(0,c.hZ)(Z.kL)}},function(e){e.O(0,[674,126,762,252,971,69,744],function(){return e(e.s=3195)}),_N_E=e.O()}]);
<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-core-concepts/certificate-details">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/doc/adr/rss.xml" title="Mithril RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/doc/adr/atom.xml" title="Mithril Atom Feed"><title data-rh="true">Mithril Certificate Details | Mithril</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://input-output-hk.github.io/doc/core-concepts/certificate-details"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Mithril Certificate Details | Mithril"><meta data-rh="true" name="description" content="This document covers an open discussion on some important details required to"><meta data-rh="true" property="og:description" content="This document covers an open discussion on some important details required to"><link data-rh="true" rel="icon" href="/doc/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://input-output-hk.github.io/doc/core-concepts/certificate-details"><link data-rh="true" rel="alternate" href="https://input-output-hk.github.io/doc/core-concepts/certificate-details" hreflang="en"><link data-rh="true" rel="alternate" href="https://input-output-hk.github.io/doc/core-concepts/certificate-details" hreflang="x-default"><link rel="stylesheet" href="/doc/assets/css/styles.7e29f003.css">
<link rel="preload" href="/doc/assets/js/runtime~main.ba315cdc.js" as="script">
<link rel="preload" href="/doc/assets/js/main.7c29440d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/doc/"><div class="navbar__logo"><img src="/doc/img/logo.png" alt="Mithril Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/doc/img/logo.png" alt="Mithril Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Mithril</b></a><a class="navbar__item navbar__link" href="/doc/intro">Getting Started</a><a class="navbar__item navbar__link navbar__link--active" href="/doc/core-concepts/">Core Concepts</a><a class="navbar__item navbar__link" href="/doc/topologies/">Topologies</a><a class="navbar__item navbar__link" href="/doc/test-lab/">Test Lab</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">developer doc</a><ul class="dropdown__menu"><li><a href="http://mithril.network/mithril-aggregator/doc/mithril_aggregator/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Aggregator Rust documentation</a></li><li><a href="http://mithril.network/mithril-signer/doc/mithril_signer/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Signer Rust documentation</a></li><li><a href="http://mithril.network/mithril-client/doc/mithril_client/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Client Rust documentation</a></li><li><a class="dropdown__link" href="/doc/aggregator-api">Aggegator HTTP API</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/doc/glossary">Glossary</a><a class="navbar__item navbar__link" href="/doc/adr">ADRs</a><a href="https://github.com/input-output-hk/mithril/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" html=":before"></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/core-concepts/">Core concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/core-concepts/mithril-protocol">Mithril Protocol</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/core-concepts/cardano-apis">Cardano APIs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/doc/core-concepts/certificate-details">Mithril Certificate Details</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/core-concepts/spv">Simple Payment Verification</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/doc/">üè†</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">Mithril Certificate Details</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Mithril Certificate Details</h1><p>This document covers an open discussion on some important details required to
build the certificates in general, and we give particular importance into how
to create the certificate chain. More specifically, this document presents some
ideas on the following topic: </p><ul><li>Role of the aggregator, </li><li>Certificate granularity, </li><li>Not collect enough signatures, and </li><li>How messages to be signed are obtained,   </li></ul><p>Open questions:</p><ul class="contains-task-list contains-task-list_tsSF"><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Define a rule to handle the case where we receive valid certificates for
two different messages in a single &quot;mithril epoch&quot;.</li><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Define a rule to handle mithril skipping a full Cardano epoch. This is
unlikelly, but we should define what to do in that case.</li><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Is it an undesirable burden for users to produce themselves the message
to be signed?</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="role-of-the-aggregator">Role of the aggregator<a class="hash-link" href="#role-of-the-aggregator" title="Direct link to heading">‚Äã</a></h2><p>What would happen if some aggregator claims not enough signatures were
received? This doesn‚Äôt really matter, as there will be a different
aggregator that will collect sufficient signatures and aggregate them
into a valid certificate. Similarly, different aggregators might have
different views of the signatures submitted (one aggregator might receive
10 signatures, and a different one could receive 11), which would result
in different certificates signing the same message. Again, this is not a
problem, as long as they certify the same message (we should specify
what to do if we receive more than one message signed in the same
&quot;mithril epoch&quot;). </p><p>As a result, aggregator should not be responsible for distributing the
snapshot. There should be a separate entity that receives aggregated
certificates, and then distributes the snapshot.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="certificate-granularity">Certificate granularity<a class="hash-link" href="#certificate-granularity" title="Direct link to heading">‚Äã</a></h2><p>There is no requirements on the certificate granularity. However, it is
desirable that there always is <em>at least</em> one certificate per new stake
distribution. Given that in Cardano the stake distribution is updated at
each epoch, we should aim towards guaranteeing one valid certificate per
epoch. However, given that certificate generation is pseudorandom, there
exists the possibility of skipping some certificates (we present below
the probability of this happening). Therefore, having more than one
certificate per epoch seems a good option, specially because when bootstrapping
a new node, one only needs to verify one certificate per epoch. </p><p>Recall that when you are bootstrapping you only really care about the
signature of the next stake distribution (and not about the state of the
node). Therefore, if we have more than one certificate per epoch, when we
are bootstrapping we don‚Äôt need to verify all these certificates. We only
need to verify the certificates that certify the next stake distribution,
and not those that maintain the distribution of the previous certificate.
A node that is bootstrapping only really needs to verify the first
certificate (or the last, really depends how we organise the message signed),
of each different stake distribution, hence of each epoch. The other
certificates are not required, as what a node is doing while bootstrapping
is verifying the stake changes to be able to validate the next certificate.
Therefore, even if we produce 10 certificates per epoch, when a node is
bootstrapping it can verify one certificate per epoch, until the last one,
where it verifies all existing certificates.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="not-enough-signatures">Not enough signatures<a class="hash-link" href="#not-enough-signatures" title="Direct link to heading">‚Äã</a></h2><p>As mentioned above, the creation of certificates is pseudorandom, so we
might find ourselves in a situation where the submitted signatures are not
enough. As presented in the paper, the goal is to make the probability of this
happening as small as possible, while guaranteeing that an adversary will not
be able to generate invalid certificates. Table 2 of the paper is interesting
to discuss this (it shows required values of k, n so that an adversarial
quorum is formed with P ‚â§ 2 ^{‚àí128}). The table shows different values, but if
we take for instance œÜ(.55), and assume adversarial stake of 40%, the
probability of reaching a quorum is 99.999% (assuming adversarial stake does not
participate). If we consider an adversarial stake of 33%, then with œÜ(.60) we
would reach a quorum with probability of 99.667%. We can also think of adversarial
stake as nodes which are not available.
Nonetheless, what to do when these events happen, and we don‚Äôt have a certificate.
The paper mentions the possibility of using a counter:
&quot;<em>if the probability of an honest quorum remains significant it can be boosted by
allowing retries (e.g by attaching a short counter to the message)</em>&quot;.<br>
<!-- -->However, there would also be the possibility of skipping a certificate, and
signing the next one. The probabilities of not reaching a quorum are so small
that it is unlikely that we will skip several blocks in a row. Skipping one (or
even a few) block is not problematic (as long as we have one per epoch, in the
opposite case we should reconsider what to do, as this becomes a bit uglier wrt
long range attacks).</p><p>The other mitigation approach is to have a sort of hybrid parametrization, where
we would run a big (k,m) pair and a small one at the same time.
If aggregators can find enough signatures in the small param set, they prefer
that, if not they use the larger params. Might be clunkier for rewards though.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="signers-know-if-not-enough-signatures-were-reached">Signers know if not enough signatures were reached<a class="hash-link" href="#signers-know-if-not-enough-signatures-were-reached" title="Direct link to heading">‚Äã</a></h3><p>If we allow signers to also be aggregators, and therefore listen and accumulate
signatures, then they will know how many are being received and whether the
quorum is being reached or not. If we use the index solution proposed above,
a signer could get a grasp of whether the quorum is going to be reached or not, and start
trying with the next index. If we don‚Äôt follow the index solution, then signers don‚Äôt really
care whether the quorum was reached or not, they simply proceed with the next signature.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="how-messages-are-obtained">How messages are obtained<a class="hash-link" href="#how-messages-are-obtained" title="Direct link to heading">‚Äã</a></h2><p>The message to be signed is chosen by the signer itself. It is not received
externally. If I‚Äôm a signer, I should have sufficient information to select
what message I need to sign--this is, the stake distribution and aggregate key,
and the state of the node at the block number for which we are producing a
signature. Given that choosing the message is a deterministic procedure,
all honest nodes will generate a signature for the same message. Following
this, there is no room for adversaries to request signatures for adversarial
messages, nor the need for signers to validate the message to be signed.</p><p>To guarantee that users have the same view of what is being signed, the
snapshots are created past <em>k</em> blocks (security parameter), which already
gives high guarantees we have reached consensus.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/input-output-hk/mithril/tree/main/docs/root/root/core-concepts/certificate-details.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/doc/core-concepts/cardano-apis"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Cardano APIs</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/doc/core-concepts/spv"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Simple Payment Verification</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#role-of-the-aggregator" class="table-of-contents__link toc-highlight">Role of the aggregator</a></li><li><a href="#certificate-granularity" class="table-of-contents__link toc-highlight">Certificate granularity</a></li><li><a href="#not-enough-signatures" class="table-of-contents__link toc-highlight">Not enough signatures</a><ul><li><a href="#signers-know-if-not-enough-signatures-were-reached" class="table-of-contents__link toc-highlight">Signers know if not enough signatures were reached</a></li></ul></li><li><a href="#how-messages-are-obtained" class="table-of-contents__link toc-highlight">How messages are obtained</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://iohk.io/en/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Input Output (Blog)</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 <strong>Input Output</strong> <br> <small>Built with Docusaurus</small></div></div></div></footer></div>
<script src="/doc/assets/js/runtime~main.ba315cdc.js"></script>
<script src="/doc/assets/js/main.7c29440d.js"></script>
</body>
</html>
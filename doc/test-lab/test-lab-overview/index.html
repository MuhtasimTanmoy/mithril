<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-test-lab/test-lab-overview">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/doc/adr/rss.xml" title="Mithril RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/doc/adr/atom.xml" title="Mithril Atom Feed"><title data-rh="true">Overview | Mithril</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://input-output-hk.github.io/doc/test-lab/test-lab-overview"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Overview | Mithril"><meta data-rh="true" name="description" content="The following picture describes in high-level box-and-wire diagram how a Mithril Test Lab would instrument Mithril nodes"><meta data-rh="true" property="og:description" content="The following picture describes in high-level box-and-wire diagram how a Mithril Test Lab would instrument Mithril nodes"><link data-rh="true" rel="icon" href="/doc/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://input-output-hk.github.io/doc/test-lab/test-lab-overview"><link data-rh="true" rel="alternate" href="https://input-output-hk.github.io/doc/test-lab/test-lab-overview" hreflang="en"><link data-rh="true" rel="alternate" href="https://input-output-hk.github.io/doc/test-lab/test-lab-overview" hreflang="x-default"><link rel="stylesheet" href="/doc/assets/css/styles.7e29f003.css">
<link rel="preload" href="/doc/assets/js/runtime~main.6a7b6e56.js" as="script">
<link rel="preload" href="/doc/assets/js/main.7c29440d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/doc/"><div class="navbar__logo"><img src="/doc/img/logo.png" alt="Mithril Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/doc/img/logo.png" alt="Mithril Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Mithril</b></a><a class="navbar__item navbar__link" href="/doc/intro">Getting Started</a><a class="navbar__item navbar__link" href="/doc/core-concepts/">Core Concepts</a><a class="navbar__item navbar__link" href="/doc/topologies/">Topologies</a><a class="navbar__item navbar__link navbar__link--active" href="/doc/test-lab/">Test Lab</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">developer doc</a><ul class="dropdown__menu"><li><a href="http://mithril.network/mithril-aggregator/doc/mithril_aggregator/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Aggregator Rust documentation</a></li><li><a href="http://mithril.network/mithril-signer/doc/mithril_signer/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Signer Rust documentation</a></li><li><a href="http://mithril.network/mithril-client/doc/mithril_client/index.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Client Rust documentation</a></li><li><a class="dropdown__link" href="/doc/aggregator-api">Aggegator HTTP API</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/doc/glossary">Glossary</a><a class="navbar__item navbar__link" href="/doc/adr">ADRs</a><a href="https://github.com/input-output-hk/mithril/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" html=":before"></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/test-lab/">Mithril Test Lab</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/doc/test-lab/test-lab-overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/test-lab/test-lab-design">Design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/test-lab/mithril-adversarial-scenarios">Adversarial Events</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/doc/">üè†</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">Overview</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Mithril Test Lab</h1><p>The following picture describes in high-level box-and-wire diagram how a Mithril Test Lab would instrument Mithril nodes
to run complex adversarial tests.</p><p><img loading="lazy" src="/doc/assets/images/mithril-test-lab-aa15f8a9c40c28d7b3fbaa3e48844ac2.jpg" width="4735" height="3378" class="img_E7b_"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="why">Why?<a class="hash-link" href="#why" title="Direct link to heading">‚Äã</a></h2><p>Mithril is both:</p><ol><li>A somewhat complex protocol to produce Stake based Threshold Multi-signatures. It depends on relatively sophisticated
cryptographic algorithms, and mathematical proofs defining security properties and requirements,</li><li>A set of nodes which run the protocol over a dedicated p2p network, producing signatures, certificates and delivering
relevant data to clients.</li></ol><p>As the goal of building Mithril network is to provide trusted data to clients without requiring them to run the full
chain themselves, it is necessary to ensure the basic properties of the &quot;abstract&quot; protocol are indeed provided by the &quot;
concrete&quot; implementation. We plan to reach this goal by developing a <em>Model-based testing framework</em> for Mithril that
should be able to check implementation of actual nodes against expected behaviour, under various scenarios and load
from &quot;happy path&quot; to &quot;adversarial conditions&quot;.</p><p>The <em>Mithril Test Lab</em> should be as agnostic as possible about the actual implementation of the nodes.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="what">What?<a class="hash-link" href="#what" title="Direct link to heading">‚Äã</a></h2><p>The Mithril Test Lab is expected to provide the tooling to build, run, and check the result of those tests. It should be
able to:</p><ul><li>Deploy and run a set of Mithril (and Cardano) nodes from some binary packages,</li><li>Control the network through which Mithril nodes are interacting in order to observe the flow of messages related to
the Mithril protocol, and intercept them in order to inject delays, reorderings, faults and arbtitrary messages,</li><li>Drive the system from the outside, injecting transactions into the instrumented Cardano network and behaving as
clients, interacting with Mithril nodes through their exposed public API,</li><li>Impersonate one or more &quot;normal&quot; Mithril nodes and run<em>Adversarial</em> nodes, trying to &quot;game&quot; the system under various
conditions of stakes and degrees of control.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="how">How?<a class="hash-link" href="#how" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="2022-03-07---defining-a-1st-increment">2022-03-07 - Defining a 1st increment<a class="hash-link" href="#2022-03-07---defining-a-1st-increment" title="Direct link to heading">‚Äã</a></h3><h4 class="anchor anchorWithStickyNavbar_mojV" id="where-are-we">Where are we?<a class="hash-link" href="#where-are-we" title="Direct link to heading">‚Äã</a></h4><ul><li>Sketched <a href="https://github.com/input-output-hk/mithril/tree/main/mithril-test-lab/mithril-monitor" target="_blank" rel="noopener noreferrer">monitor</a> as the way
to specify expected behaviour of Mithril network and nodes in Haskell<ul><li><code>Monitor</code>s are <em>composable observers</em> that can <em>monitor</em> the trace of observable behaviour of interconnected
Mithril nodes to verify some protocol invariants</li><li>Users can define basic assertions, properties, invariants, using the language provided by monitors</li><li>They should also be used to <em>drive</em> the network, eg. decide when to request signature, when to retrieve
certificate and verify them...</li><li>In essence, <code>Monitor</code>s are an eDSL somewhat akin
to <a href="https://serokell.io/blog/introduction-to-free-monads" target="_blank" rel="noopener noreferrer">Free monads</a> to represent interesting tests about a
Mithril network, or more precisely to represent <em>executable specifications</em></li><li>Monitors are interesting if thye provide more abstracting power than mere test examples, eg. express composable
behaviour, up to interleaving, provided generative power to be able to abstract from details...</li></ul></li><li>Sketched <a href="https://github.com/input-output-hk/mithril/tree/main/mithril-proto/test-node" target="_blank" rel="noopener noreferrer">Rust mithril node</a> which is
expected to evolve into some kind of <em>reference implementation</em> of the Mithril protocol<ul><li>As the underlying library is written in Rust, a Rust node should be &quot;easy&quot; to implement and provides more
assurance we are actually uysing the protocol right</li><li>This &quot;node&quot;&#x27;s usefulness hinges on the fact it really can be instrumented by the monitors&#x27; or an over-arching
driver/orchestrator: It does not have to implement all the complexity of networking and orchestration a real node
entails, it only serves as an <em>oracle</em> against which to check the actual node&#x27;s implementation</li><li><em>but</em> it&#x27;s also useful as a way to test the <code>Monitor</code> mechanics, and as a surrogate for the real node while we are
developing the actual node <em>and</em> the test lab itself</li><li>Hence the need to have a thin REST layer that exposes an API similar to waht the node provides, which is also a
good way to test-drive the real node itself, e.g making it clear what the API should look like in order for the
node to be testable</li><li>However, in this latter role the rust node does not need to implement the protocol in full details, it can just
provide canned answers which are <em>just enough</em> to be useful from the monitors&#x27; perspective</li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="what-a-first-increment-should-be">What a first increment should be?<a class="hash-link" href="#what-a-first-increment-should-be" title="Direct link to heading">‚Äã</a></h4><p>A first concrete deliverable milestone for this project could be made of the following.</p><ul><li>A Design document:<ul><li>There is a general lack of written documentation about the ideas, rationale, design decisions behind all the
above, and this is different from implementation-level documentation which <em>should also</em> be there but can be grown
piecemeal</li><li>This document should clarify questions and issues we have been discussing about this project and the chosen
approach</li><li>It should also clarify some plan to move forward past a first increment</li></ul></li><li>A basic end-to-end scenario:<ul><li>Demonstrates stitching together a network of (dummy, incomplete, lame,...) nodes,in our case the rust node and the
monitors in such a way that the latter &quot;drives&quot; the former and observes their behaviour</li><li>The property/invariant we express does not need to be sophisticated at first, could just be something like:<blockquote><p>Given a network of n correct nodes and some protocol parameters
When monitor issues a signing request for the same item to each of the node
Then it observes valid signatures emitted by each of the node
And each node can provide a valid certificate</p></blockquote></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">‚Äã</a></h2><ul><li><a href="https://jepsen.io/" target="_blank" rel="noopener noreferrer">Jepsen</a> is an implementation of such a MBT framework for verifying <em>linearizability</em> of consensus
protocols</li><li><a href="https://github.com/stevana/quickcheck-state-machine" target="_blank" rel="noopener noreferrer">quickcheck-state-machine</a></li><li><a href="https://quickstrom.io" target="_blank" rel="noopener noreferrer">QuickStrom</a></li><li><a href="https://plutus.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">Plutus testing framework</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/input-output-hk/mithril/tree/main/docs/root/root/test-lab/test-lab-overview.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/doc/test-lab/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Mithril Test Lab</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/doc/test-lab/test-lab-design"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Design</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why" class="table-of-contents__link toc-highlight">Why?</a></li><li><a href="#what" class="table-of-contents__link toc-highlight">What?</a></li><li><a href="#how" class="table-of-contents__link toc-highlight">How?</a><ul><li><a href="#2022-03-07---defining-a-1st-increment" class="table-of-contents__link toc-highlight">2022-03-07 - Defining a 1st increment</a></li></ul></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://iohk.io/en/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Input Output (Blog)</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 <strong>Input Output</strong> <br> <small>Built with Docusaurus</small></div></div></div></footer></div>
<script src="/doc/assets/js/runtime~main.6a7b6e56.js"></script>
<script src="/doc/assets/js/main.7c29440d.js"></script>
</body>
</html>